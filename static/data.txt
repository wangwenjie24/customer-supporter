(customer-supporter) (base) wangwenjie@192 customer-supporter % /opt/anaconda3/envs/customer-supporter/bin/python 
/Users/wangwenjie/Documents/workspace/customer-supporter/src/agent/graph.py
/Users/wangwenjie/Documents/workspace/customer-supporter/src/agent/financial_data_agent.py:164: LangChainBetaWarning: The function `init_embeddings` is in beta. It is actively being worked on, so the API may change.
  embeddings = init_embeddings("openai:text-embedding-3-small")
*************** 已加载工具: [Item(namespace=['tools'], key='8f35f9fd-c295-4727-a79c-fd66ce2235d5', value={'description': 'a1: 查询某个公司在某个会计期间的营业收入-本月数是多少'}, created_at='2025-04-28T14:43:11.956443+00:00', updated_at='2025-04-28T14:43:11.956450+00:00', score=0.49764784752818164), Item(namespace=['tools'], key='9381172b-8d04-4923-8c00-8cc8d56ffae0', value={'description': 'a2: 查询某个公司在某个会计期间的营业成本-本月数是多少'}, created_at='2025-04-28T14:43:12.667584+00:00', updated_at='2025-04-28T14:43:12.667595+00:00', score=0.4160148430583387), Item(namespace=['tools'], key='bdfca62e-c6d4-450a-bca4-bfb9d2d598c5', value={'description': 'b3: 查询某个公司在某个会计期间的其他与经营活动有关的现金是多少'}, created_at='2025-04-28T14:43:16.245797+00:00', updated_at='2025-04-28T14:43:16.245807+00:00', score=0.40719834204896843), Item(namespace=['tools'], key='c387bd18-2596-4985-8adc-79950cf47d09', value={'description': 'a3: 查询某个公司在某个会计期间的税金及附加-本月数是多少'}, created_at='2025-04-28T14:43:14.103837+00:00', updated_at='2025-04-28T14:43:14.103847+00:00', score=0.4026214755017824), Item(namespace=['tools'], key='10c6606e-6ef6-4ea4-ae41-df4228cd8099', value={'description': 'b1: 查询某个公司在某个会计期间的销售商品/提供劳务收到的现金是多少'}, created_at='2025-04-28T14:43:14.521264+00:00', updated_at='2025-04-28T14:43:14.521266+00:00', score=0.4015758599160828), Item(namespace=['tools'], key='e04b1a5d-c643-40ce-9fcf-d8e896a718d5', value={'description': 'b2: 查询某个公司在某个会计期间的收到的税费返还是多少'}, created_at='2025-04-28T14:43:15.084818+00:00', updated_at='2025-04-28T14:43:15.084822+00:00', score=0.3950146997458225)]
{'action': 'financial_data_agent', 'messages': [HumanMessage(content='查询2024年2月佛山电器照明股份有限公司营业收入同比增长多少？', additional_kwargs={}, response_metadata={}, id='cd754997-ed71-423f-bfe9-56e94bf8cc37')]}
{'action': 'financial_data_agent', 'messages': [HumanMessage(content='查询2024年2月佛山电器照明股份有限公司营业收入同比增长多少？', additional_kwargs={}, response_metadata={}, id='cd754997-ed71-423f-bfe9-56e94bf8cc37')]}
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': 'call_2FH5Ee5HvmrBziDjI7iO89dH', 'function': {'arguments': '', 'name': 'retrieve_tools'}, 'type': 'function'}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', tool_calls=[{'name': 'retrieve_tools', 'args': {}, 'id': 'call_2FH5Ee5HvmrBziDjI7iO89dH', 'type': 'tool_call'}], tool_call_chunks=[{'name': 'retrieve_tools', 'args': '', 'id': 'call_2FH5Ee5HvmrBziDjI7iO89dH', 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '{"', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', tool_calls=[{'name': '', 'args': {}, 'id': None, 'type': 'tool_call'}], tool_call_chunks=[{'name': None, 'args': '{"', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': 'query', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': 'query', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': 'query', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '":"', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '":"', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '":"', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '202', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '202', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '202', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '4', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '4', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '4', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '年', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '年', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '年', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '2', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '2', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '2', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '月', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '月', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '月', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '佛', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '佛', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '佛', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '山', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '山', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '山', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '电', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '电', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '电', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '器', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '器', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '器', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '照', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '照', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '照', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '明', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '明', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '明', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '股份', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '股份', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '股份', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '有限公司', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '有限公司', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '有限公司', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '营业', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '营业', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '营业', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '收入', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '收入', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '收入', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '同比', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '同比', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '同比', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '增长', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '增长', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '增长', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '情况', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '情况', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '情况', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': None, 'function': {'arguments': '"}', 'name': None}, 'type': None}]}, response_metadata={}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b', invalid_tool_calls=[{'name': None, 'args': '"}', 'id': None, 'error': None, 'type': 'invalid_tool_call'}], tool_call_chunks=[{'name': None, 'args': '"}', 'id': None, 'index': 0, 'type': 'tool_call_chunk'}]), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
(AIMessageChunk(content='', additional_kwargs={}, response_metadata={'finish_reason': 'tool_calls', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_dbaca60df0'}, id='run-1815f1c5-b6e9-45d5-b491-d884c637336b'), {'thread_id': '2', 'user_id': '10001', 'user_title': '万书记', 'langgraph_step': 1, 'langgraph_node': 'agent', 'langgraph_triggers': ('branch:to:agent', 'select_tools', 'start:agent', 'tools'), 'langgraph_path': ('__pregel_pull', 'agent'), 'langgraph_checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450|agent:af859c23-f745-ad42-b086-2ddaa413e771', 'checkpoint_ns': 'finalcial_data_research:58b6ed0e-6743-c788-0948-6f4a89fd6450', 'ls_provider': 'openai', 'ls_model_name': 'gpt-4o-mini', 'ls_model_type': 'chat', 'ls_temperature': None})
Traceback (most recent call last):
  File "/Users/wangwenjie/Documents/workspace/customer-supporter/src/agent/graph.py", line 157, in <module>
    for stream_mode, streamed_output in graph.stream(inputs, stream_mode=["messages", "custom", "values"], config={"configurable": {"thread_id": "2", "user_id": "10001", "user_title": "万书记"}}):
                                        ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/pregel/__init__.py", line 2331, in stream
    for _ in runner.tick(
             ~~~~~~~~~~~^
        loop.tasks.values(),
        ^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        get_waiter=get_waiter,
        ^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/pregel/runner.py", line 232, in tick
    _panic_or_proceed(
    ~~~~~~~~~~~~~~~~~^
        futures.done.union(f for f, t in futures.items() if t is not None),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        panic=reraise,
        ^^^^^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/pregel/runner.py", line 458, in _panic_or_proceed
    raise exc
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/pregel/executor.py", line 83, in done
    task.result()
    ~~~~~~~~~~~^^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/pregel/retry.py", line 40, in run_with_retry
    return task.proc.invoke(task.input, config)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/utils/runnable.py", line 606, in invoke
    input = step.invoke(input, config, **kwargs)
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/utils/runnable.py", line 371, in invoke
    ret = context.run(self.func, *args, **kwargs)
  File "/Users/wangwenjie/Documents/workspace/customer-supporter/src/agent/graph.py", line 117, in finalcial_data_research
    result = financial_data_agent.invoke({"messages": [
                SystemMessage(content=financial_data_researcher_instructions_formatted),
                *state.messages
            ]})
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/pregel/__init__.py", line 2683, in invoke
    for chunk in self.stream(
                 ~~~~~~~~~~~^
        input,
        ^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ):
    ^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/pregel/__init__.py", line 2331, in stream
    for _ in runner.tick(
             ~~~~~~~~~~~^
        loop.tasks.values(),
        ^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        get_waiter=get_waiter,
        ^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/pregel/runner.py", line 146, in tick
    run_with_retry(
    ~~~~~~~~~~~~~~^
        t,
        ^^
    ...<11 lines>...
        },
        ^^
    )
    ^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/pregel/retry.py", line 40, in run_with_retry
    return task.proc.invoke(task.input, config)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/utils/runnable.py", line 606, in invoke
    input = step.invoke(input, config, **kwargs)
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph/utils/runnable.py", line 363, in invoke
    ret = context.run(self.func, *args, **kwargs)
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langgraph_bigtool/graph.py", line 109, in select_tools
    result = retrieve_tools.invoke(kwargs)
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langchain_core/tools/base.py", line 513, in invoke
    return self.run(tool_input, **kwargs)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langchain_core/tools/base.py", line 774, in run
    raise error_to_raise
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langchain_core/tools/base.py", line 736, in run
    tool_args, tool_kwargs = self._to_args_and_kwargs(
                             ~~~~~~~~~~~~~~~~~~~~~~~~^
        tool_input, tool_call_id
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langchain_core/tools/base.py", line 651, in _to_args_and_kwargs
    tool_input = self._parse_input(tool_input, tool_call_id)
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/langchain_core/tools/base.py", line 570, in _parse_input
    result = input_args.model_validate(tool_input)
  File "/opt/anaconda3/envs/customer-supporter/lib/python3.13/site-packages/pydantic/main.py", line 693, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        obj, strict=strict, from_attributes=from_attributes, context=context, by_alias=by_alias, by_name=by_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for retrieve_tools
store
  Input should be an instance of BaseStore [type=is_instance_of, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.11/v/is_instance_of
During task with name 'select_tools' and id '85ebdfeb-01f3-6165-fad1-ec5844e7998a'
During task with name 'finalcial_data_research' and id '58b6ed0e-6743-c788-0948-6f4a89fd6450'
(customer-supporter) (base) wangwenjie@192 customer-supporter % 